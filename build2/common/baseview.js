define("webapp/common/baseview.js",["mvc/view","webapp/common/app","webapp/models/models","webapp/stores/stores","webapp/common/global.const"],function(require){var t=require("mvc/view"),e=require("webapp/common/app"),n=require("webapp/models/models"),i=require("webapp/stores/stores");require("webapp/common/global.const");var a=i.UserStore.getInstance(),s="head-left-btn",o="head-title",d="head-right-btn",c=['<span class="btn '+s+'"<%if(hideLeftBtn){%> style="display:none"<%}%>></span>','<h3 class="'+o+'"><%=title%></h3>','<span class="btn '+d+'"<%if(hideRightBtn){%> style="display:none"<%}%>><%=rightTitle%></span>'].join("");return t.extend({propertys:function(){},initialize:function($super,t){$super(t)},setHeader:function(t){var n={};t.leftHandle&&(n["click ."+s]=t.leftHandle),window.app=window.app||{},window.app.__back=function(){t.leftHandle&&t.leftHandle.call(this),e.handler_back()}.bind(this),t.rightHandle&&(n["click ."+d]=t.rightHandle),this.toHead(this.id,{template:c,cls:t.cls,data:{title:t.title,rightTitle:t.rightTitle,hideRightBtn:t.hideRightBtn,hideLeftBtn:t.hideLeftBtn},events:n,notAnimte:t.notAnimte,space:this})},isHeaderHidden:function(){return!this.frame.header.box.height()},getUid:function(t){var i=this;e.getUserInfo({callback:function(e){var s=e.user_id,o=encodeURIComponent(e.utdid),d=a.getAttr("user"+o);if(d)return void t.call(i,d);var c=n.CreateUidModel.getInstance();c.setParam({userid:s,utdid:o}),c.request({success:function(e){a.setAttr("user"+o,e.data),t.call(i,e.data)},error:function(){i.hideLoading(),i.showToast("大家太热情了，请等下再试~",3)},cancel:function(){i.hideLoading()}})},error:function(){i.hideLoading(),i.showToast("小天有点忙，退出再重新进入~",3)},timeoutfn:function(){i.hideLoading(),i.showToast("小天有点忙，退出再重新进入~",3)},timeout:3})},getUser:function(t){this.getUid(function(e){this.getUserByUid(e._id,t)})},setBackground:function(t,e){var n=this.getRootBg();n.css("background",t),e&&n.css("background-size",e)},getUserByUid:function(t,e){var i=n.UserInfoModel.getInstance();i.setParam("uid",t),i.request({success:function(t){e.call(this,t.data)},error:function(){this.hideLoading(),this.showToast("获得用户信息失败！")},cancel:function(){this.hideLoading()}},this)},$T:function(t){return _.template(this.$(t).html())}})});